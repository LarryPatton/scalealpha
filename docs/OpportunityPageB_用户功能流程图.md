# OpportunityPageB 用户核心功能流程图

> **页面**: `OpportunityPageB`  
> **路径**: `/scalealpha/opportunityB`  
> **版本**: 1.0  
> **更新日期**: 2026-01-20

---

## 一、功能全景图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         OpportunityPageB 功能全景                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌──────────────────────┐          ┌──────────────────────┐               │
│   │    生成策略 Tab       │    ──▶   │    我的策略 Tab       │               │
│   │    (Generate)        │          │    (My Strategy)     │               │
│   └──────────────────────┘          └──────────────────────┘               │
│            │                                  │                             │
│            ▼                                  ▼                             │
│   ┌──────────────────┐              ┌──────────────────┐                   │
│   │ A. 资产选择模块   │              │ D. 策略管理模块   │                   │
│   │ B. 参数配置模块   │              │ E. 计划生成模块   │                   │
│   │ C. 策略生成模块   │              │ F. 交易执行模块   │                   │
│   └──────────────────┘              │ G. AI 对话模块    │                   │
│                                     └──────────────────┘                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、生成策略 Tab 功能模块

### 模块 A: 资产选择

```
┌─────────────────────────────────────────────────────────────────┐
│                      A. 资产选择模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [A1] 入口选择                                                 │
│         │                                                       │
│         ├──▶ [A1.1] 搜索模式 ──▶ 输入关键词 ──▶ 匹配股票列表   │
│         │                                                       │
│         └──▶ [A1.2] 关注列表 ──▶ 加载用户关注 ──▶ 显示关注股票 │
│                                                                 │
│   [A2] 资产操作                                                 │
│         │                                                       │
│         ├──▶ [A2.1] 勾选股票 ──▶ 添加到已选列表                │
│         │                                                       │
│         ├──▶ [A2.2] 取消勾选 ──▶ 从已选列表移除                │
│         │                                                       │
│         └──▶ [A2.3] 清空选择 ──▶ 清除所有已选                  │
│                                                                 │
│   [A3] 选择状态                                                 │
│         │                                                       │
│         └──▶ 显示已选标签 + 选择摘要 (X 只股票)                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**节点说明:**

| 节点 ID | 节点名称 | 输入 | 输出 | 触发条件 |
|---------|----------|------|------|----------|
| A1.1 | 搜索模式 | 关键词 | 匹配股票列表 | 输入搜索框 |
| A1.2 | 关注列表 | 用户ID | 关注股票列表 | 切换到关注 Tab |
| A2.1 | 勾选股票 | 股票对象 | 已选列表更新 | 点击复选框 |
| A2.2 | 取消勾选 | 股票symbol | 已选列表更新 | 再次点击 |
| A2.3 | 清空选择 | - | 已选列表清空 | 点击清空按钮 |

---

### 模块 B: 参数配置

```
┌─────────────────────────────────────────────────────────────────┐
│                      B. 参数配置模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [B1] 分析框架选择                                             │
│         │                                                       │
│         ├──▶ [B1.1] 智能推荐 (auto) ──▶ AI 自动选择框架        │
│         │                                                       │
│         └──▶ [B1.2] 手动选择 ──▶ 可多选以下框架:               │
│               ├─ 技术分析 (technical)                          │
│               ├─ 基本面分析 (fundamental)                      │
│               ├─ 事件驱动 (event)                              │
│               ├─ 量化分析 (quant)                              │
│               ├─ 情绪分析 (sentiment)                          │
│               ├─ 宏观分析 (macro)                              │
│               └─ 期权分析 (options)                            │
│                                                                 │
│   [B2] 投资期限选择                                             │
│         │                                                       │
│         └──▶ [单选] auto / ultra-short / short / medium / long │
│                                                                 │
│   [B3] 风险偏好选择                                             │
│         │                                                       │
│         └──▶ [单选] auto / conservative / moderate / growth /  │
│                      aggressive                                 │
│                                                                 │
│   [B4] 个人洞察 (可选)                                          │
│         │                                                       │
│         ├──▶ [B4.1] 宏观市场观点 ──▶ 文本输入                  │
│         │                                                       │
│         └──▶ [B4.2] 标的深度洞察 ──▶ 文本输入                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**节点说明:**

| 节点 ID | 节点名称 | 类型 | 默认值 | 必填 |
|---------|----------|------|--------|------|
| B1 | 分析框架 | 多选 | [auto] | ✅ |
| B2 | 投资期限 | 单选 | auto | ✅ |
| B3 | 风险偏好 | 单选 | auto | ✅ |
| B4.1 | 宏观观点 | 文本 | 空 | ❌ |
| B4.2 | 标的洞察 | 文本 | 空 | ❌ |

---

### 模块 C: 策略生成

```
┌─────────────────────────────────────────────────────────────────┐
│                      C. 策略生成模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [C1] 生成前检查                                               │
│         │                                                       │
│         ├──▶ [C1.1] 检查资产 ──▶ selectedStocks.length > 0    │
│         │                                                       │
│         ├──▶ [C1.2] 检查框架 ──▶ selectedFrameworks.length > 0│
│         │                                                       │
│         └──▶ [C1.3] 检查积分 ──▶ userCredits >= 20            │
│               │                                                 │
│               ├─ [通过] ──▶ 启用生成按钮                       │
│               │                                                 │
│               └─ [不足] ──▶ 显示充值按钮                       │
│                                                                 │
│   [C2] 触发生成                                                 │
│         │                                                       │
│         └──▶ 点击「生成策略」按钮                              │
│                                                                 │
│   [C3] 创建任务                                                 │
│         │                                                       │
│         └──▶ 为每个选中股票创建 pending 任务                   │
│               │                                                 │
│               └──▶ 任务进入队列                                │
│                                                                 │
│   [C4] 任务处理                                                 │
│         │                                                       │
│         ├──▶ [C4.1] pending ──▶ 等待队列处理                   │
│         │                                                       │
│         ├──▶ [C4.2] processing ──▶ 显示进度条 + 剩余时间       │
│         │                                                       │
│         └──▶ [C4.3] completed ──▶ 保存到策略库                 │
│                                                                 │
│   [C5] 生成完成                                                 │
│         │                                                       │
│         ├──▶ [成功] ──▶ 显示成功 Toast + 自动切换到我的策略    │
│         │                                                       │
│         └──▶ [失败] ──▶ 显示错误 Toast + 标记 ERROR 状态       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**流程图:**

```
     ┌──────────┐
     │  开始    │
     └────┬─────┘
          │
          ▼
   ┌──────────────┐     ❌     ┌──────────────┐
   │ 资产已选择？ │ ─────────▶ │ 提示选择资产 │
   └──────┬───────┘            └──────────────┘
          │ ✅
          ▼
   ┌──────────────┐     ❌     ┌──────────────┐
   │ 框架已选择？ │ ─────────▶ │ 提示选择框架 │
   └──────┬───────┘            └──────────────┘
          │ ✅
          ▼
   ┌──────────────┐     ❌     ┌──────────────┐
   │ 积分充足？   │ ─────────▶ │ 显示充值入口 │
   └──────┬───────┘            └──────────────┘
          │ ✅
          ▼
   ┌──────────────┐
   │ 创建任务队列 │
   └──────┬───────┘
          │
          ▼
   ┌──────────────┐
   │ 处理任务... │ ◀─────┐
   └──────┬───────┘       │
          │               │
          ▼               │
   ┌──────────────┐   还有任务
   │ 任务完成？   │ ──────┘
   └──────┬───────┘
          │ 全部完成
          ▼
   ┌──────────────┐
   │ 保存到策略库 │
   └──────┬───────┘
          │
          ▼
     ┌──────────┐
     │   结束   │
     └──────────┘
```

---

## 三、我的策略 Tab 功能模块

### 模块 D: 策略管理

```
┌─────────────────────────────────────────────────────────────────┐
│                      D. 策略管理模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [D1] 策略筛选                                                 │
│         │                                                       │
│         ├──▶ [D1.1] 分组筛选                                   │
│         │     ├─ 全部策略 (all)                                │
│         │     ├─ 官方策略 (official)                           │
│         │     ├─ 我的策略 (my)                                 │
│         │     ├─ 有计划的 (plans)                              │
│         │     └─ 仅计划 (only-plan)                            │
│         │                                                       │
│         ├──▶ [D1.2] 智能筛选                                   │
│         │     ├─ 高评级 (A/B)                                  │
│         │     ├─ 建议更新                                      │
│         │     ├─ 无信号记录                                    │
│         │     └─ 未发现机会                                    │
│         │                                                       │
│         ├──▶ [D1.3] 方向筛选 ──▶ 全部 / 做多 / 做空            │
│         │                                                       │
│         └──▶ [D1.4] 关键词搜索 ──▶ 匹配代码/名称               │
│                                                                 │
│   [D2] 策略排序                                                 │
│         │                                                       │
│         └──▶ 点击表头 ──▶ 按字段排序 (升序/降序)               │
│               可排序: 名称 / 评级 / 期限 / 创建时间            │
│                                                                 │
│   [D3] 策略选择                                                 │
│         │                                                       │
│         ├──▶ [D3.1] 单选 ──▶ 点击行选中策略                    │
│         │                                                       │
│         ├──▶ [D3.2] 多选 ──▶ 勾选复选框                        │
│         │                                                       │
│         └──▶ [D3.3] 全选 ──▶ 勾选表头复选框                    │
│                                                                 │
│   [D4] 策略操作                                                 │
│         │                                                       │
│         ├──▶ [D4.1] 查看详情 ──▶ 打开策略详情模态框            │
│         │                                                       │
│         ├──▶ [D4.2] 生成计划 ──▶ 进入计划生成模块 (E)          │
│         │                                                       │
│         ├──▶ [D4.3] 更新策略 ──▶ 重新生成策略内容              │
│         │                                                       │
│         ├──▶ [D4.4] 移动分组 ──▶ 选择目标分组                  │
│         │                                                       │
│         └──▶ [D4.5] 删除策略 ──▶ 确认删除 ──▶ 从库中移除       │
│                                                                 │
│   [D5] 分组管理                                                 │
│         │                                                       │
│         ├──▶ [D5.1] 新建分组 ──▶ 输入分组名称 ──▶ 创建        │
│         │                                                       │
│         └──▶ [D5.2] 删除分组 ──▶ 确认删除 ──▶ 移除分组        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**策略状态节点:**

```
┌─────────────────────────────────────────────────────────────────┐
│                     策略状态流转                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [正常状态]                                                    │
│       │                                                         │
│       ├──▶ 评级 A/B/C ──▶ 可生成计划                           │
│       │                                                         │
│       └──▶ 评级 N/A ──▶ 未发现机会，无法生成计划               │
│                                                                 │
│   [异常状态]                                                    │
│       │                                                         │
│       ├──▶ ERROR ──▶ 生成失败，可点击重试                      │
│       │                                                         │
│       └──▶ isExpired ──▶ 已失效，建议更新                      │
│                                                                 │
│   [更新状态]                                                    │
│       │                                                         │
│       ├──▶ strategyNeedsUpdate ──▶ 显示更新提示                │
│       │                                                         │
│       └──▶ regenerating ──▶ 显示更新进度                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 模块 E: 计划生成

```
┌─────────────────────────────────────────────────────────────────┐
│                      E. 计划生成模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [E1] 触发入口                                                 │
│         │                                                       │
│         ├──▶ [E1.1] 策略行 ──▶ 点击「生成计划」按钮            │
│         │                                                       │
│         └──▶ [E1.2] 详情框 ──▶ 点击「生成新计划」按钮          │
│                                                                 │
│   [E2] 打开配置面板                                             │
│         │                                                       │
│         └──▶ 弹出「生成计划模态框」                            │
│                                                                 │
│   [E3] 配置持仓状态                                             │
│         │                                                       │
│         ├──▶ [E3.1] 无持仓 (No Position)                       │
│         │     └──▶ 跳过持仓配置                                │
│         │                                                       │
│         └──▶ [E3.2] 有持仓 (Have Position)                     │
│               │                                                 │
│               ├──▶ 输入成本价 (Avg Cost)                       │
│               │                                                 │
│               ├──▶ 输入仓位占比 (Size %)                       │
│               │                                                 │
│               └──▶ 自动计算 P&L                                │
│                                                                 │
│   [E4] 配置投资偏好                                             │
│         │                                                       │
│         ├──▶ [E4.1] 投资期限 (Horizon)                         │
│         │     ├─ Short (1-4周)                                 │
│         │     ├─ Medium (1-3月)                                │
│         │     └─ Long (3+月)                                   │
│         │                                                       │
│         └──▶ [E4.2] 风险偏好 (Risk Level)                      │
│               └──▶ 滑块 0-100                                  │
│                    ├─ 0-25: Conservative                       │
│                    ├─ 25-50: Moderate                          │
│                    ├─ 50-75: Growth                            │
│                    └─ 75-100: Aggressive                       │
│                                                                 │
│   [E5] 保存配置                                                 │
│         │                                                       │
│         └──▶ [可选] 勾选「Save as default」                    │
│                                                                 │
│   [E6] 确认生成                                                 │
│         │                                                       │
│         ├──▶ 点击「Generate」按钮                              │
│         │                                                       │
│         ├──▶ 创建计划对象 (isGenerating: true)                 │
│         │                                                       │
│         ├──▶ 显示生成进度                                      │
│         │                                                       │
│         └──▶ 完成后显示在计划列表中                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**流程图:**

```
     ┌──────────────────┐
     │ 点击「生成计划」 │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐     ❌     ┌──────────────────┐
     │ 积分充足？       │ ─────────▶ │ 提示积分不足     │
     └────────┬─────────┘            │ 显示充值入口     │
              │ ✅                   └──────────────────┘
              ▼
     ┌──────────────────┐
     │ 打开配置模态框   │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 选择持仓状态     │
     └────────┬─────────┘
              │
      ┌───────┴───────┐
      │               │
      ▼               ▼
 ┌─────────┐    ┌─────────────┐
 │ 无持仓  │    │ 有持仓      │
 └────┬────┘    └──────┬──────┘
      │                │
      │                ▼
      │         ┌─────────────┐
      │         │ 输入成本价  │
      │         │ 输入仓位    │
      │         └──────┬──────┘
      │                │
      └───────┬────────┘
              │
              ▼
     ┌──────────────────┐
     │ 选择投资期限     │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 设置风险偏好     │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 点击「Generate」 │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 生成中...        │
     │ (显示进度条)     │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 计划生成完成     │
     │ 显示在计划列表   │
     └──────────────────┘
```

---

### 模块 F: 交易执行

```
┌─────────────────────────────────────────────────────────────────┐
│                      F. 交易执行模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [F1] 触发入口                                                 │
│         │                                                       │
│         ├──▶ [F1.1] 计划列表 ──▶ 点击「执行」按钮              │
│         │                                                       │
│         └──▶ [F1.2] 计划详情 ──▶ 点击「Execute」按钮           │
│                                                                 │
│   [F2] 选择执行目标                                             │
│         │                                                       │
│         ├──▶ [F2.1] 券商账户 (Broker)                          │
│         │     └──▶ 选择已连接的券商账户                        │
│         │                                                       │
│         └──▶ [F2.2] 模拟盘 (Paper Trading)                     │
│               └──▶ 选择模拟盘组合                              │
│                                                                 │
│   [F3] 配置订单参数                                             │
│         │                                                       │
│         ├──▶ [F3.1] 交易方向 ──▶ 买入 / 卖出                   │
│         │                                                       │
│         ├──▶ [F3.2] 交易数量 ──▶ 股数输入                      │
│         │                                                       │
│         ├──▶ [F3.3] 订单类型 ──▶ 市价单 / 限价单               │
│         │     │                                                 │
│         │     └──▶ [限价单] ──▶ 输入限价价格                   │
│         │                                                       │
│         ├──▶ [F3.4] 目标价 ──▶ [可选] 设置止盈价               │
│         │                                                       │
│         └──▶ [F3.5] 止损价 ──▶ [可选] 设置止损价               │
│                                                                 │
│   [F4] 确认执行                                                 │
│         │                                                       │
│         ├──▶ 点击「确认」按钮                                  │
│         │                                                       │
│         ├──▶ 订单提交到目标账户                                │
│         │                                                       │
│         └──▶ 显示执行结果 Toast                                │
│                                                                 │
│   [F5] 无账户处理                                               │
│         │                                                       │
│         ├──▶ 无券商账户 ──▶ 显示「添加券商」入口               │
│         │                                                       │
│         └──▶ 无模拟盘 ──▶ 显示「创建模拟盘」入口               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**执行流程图:**

```
     ┌──────────────────┐
     │ 点击「执行」按钮 │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 选择账户类型     │
     └────────┬─────────┘
              │
      ┌───────┴───────┐
      │               │
      ▼               ▼
 ┌─────────┐    ┌─────────────┐
 │ 券商    │    │ 模拟盘      │
 └────┬────┘    └──────┬──────┘
      │                │
      ▼                ▼
 ┌─────────┐    ┌─────────────┐
 │有账户？ │    │ 有组合？    │
 └────┬────┘    └──────┬──────┘
      │                │
   ✅ │ ❌          ✅ │ ❌
      │  │             │  │
      │  ▼             │  ▼
      │ [添加]         │ [创建]
      │                │
      └───────┬────────┘
              │
              ▼
     ┌──────────────────┐
     │ 配置订单参数     │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 确认订单         │
     └────────┬─────────┘
              │
              ▼
     ┌──────────────────┐
     │ 执行成功         │
     └──────────────────┘
```

---

### 模块 G: AI 对话

```
┌─────────────────────────────────────────────────────────────────┐
│                       G. AI 对话模块                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [G1] 触发入口                                                 │
│         │                                                       │
│         └──▶ 打开策略详情模态框 ──▶ 左侧对话区                 │
│                                                                 │
│   [G2] 初始状态                                                 │
│         │                                                       │
│         ├──▶ 显示 AI 助手欢迎信息                              │
│         │                                                       │
│         └──▶ 显示快捷问题模板                                  │
│               ├─ 「这个策略的核心观点是什么？」                │
│               ├─ 「有哪些主要风险需要注意？」                  │
│               ├─ 「推荐的入场时机是什么？」                    │
│               └─ ...                                           │
│                                                                 │
│   [G3] 发送消息                                                 │
│         │                                                       │
│         ├──▶ [G3.1] 点击快捷问题 ──▶ 自动填入并发送            │
│         │                                                       │
│         └──▶ [G3.2] 输入自定义问题 ──▶ 按 Enter 发送           │
│                                                                 │
│   [G4] 接收回复                                                 │
│         │                                                       │
│         ├──▶ 显示加载动画 (...)                                │
│         │                                                       │
│         └──▶ 流式输出 AI 回复                                  │
│                                                                 │
│   [G5] 积分控制                                                 │
│         │                                                       │
│         ├──▶ 每次对话消耗 2 积分                               │
│         │                                                       │
│         └──▶ [积分不足] ──▶ 禁用输入框 + 显示充值提示          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 四、模块间关联关系

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           模块关联关系图                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌───────────────────────── 生成策略 Tab ─────────────────────────┐        │
│   │                                                                │        │
│   │   [A] 资产选择 ─────▶ [B] 参数配置 ─────▶ [C] 策略生成       │        │
│   │                                                                │        │
│   └────────────────────────────────┬───────────────────────────────┘        │
│                                    │                                        │
│                                    │ 生成完成后保存                         │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────┐       │
│   │                                                                 │       │
│   │                    ┌──────────────────┐                        │       │
│   │                    │  D. 策略管理     │                        │       │
│   │                    │    (策略库)      │                        │       │
│   │                    └────────┬─────────┘                        │       │
│   │                             │                                  │       │
│   │              ┌──────────────┼──────────────┐                   │       │
│   │              │              │              │                   │       │
│   │              ▼              ▼              ▼                   │       │
│   │    ┌─────────────┐  ┌────────────┐  ┌────────────┐            │       │
│   │    │ G. AI对话   │  │ E. 计划生成│  │ D4.3 更新  │            │       │
│   │    │   (讨论)    │  │            │  │            │            │       │
│   │    └─────────────┘  └─────┬──────┘  └────────────┘            │       │
│   │                           │                                    │       │
│   │                           ▼                                    │       │
│   │                    ┌────────────┐                              │       │
│   │                    │ F. 交易执行│                              │       │
│   │                    └─────┬──────┘                              │       │
│   │                          │                                     │       │
│   │                          ▼                                     │       │
│   │                 ┌─────────────────┐                            │       │
│   │                 │ 券商/模拟盘账户 │                            │       │
│   │                 └─────────────────┘                            │       │
│   │                                                                 │       │
│   └──────────────────────── 我的策略 Tab ───────────────────────────┘       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 五、核心用户旅程

### 旅程 1: 首次生成策略

```
[1] 进入生成策略Tab
       │
       ▼
[2] 搜索并选择目标股票 (如 AAPL, GOOGL)
       │
       ▼
[3] 选择分析框架 (选择"智能推荐"或多选具体框架)
       │
       ▼
[4] 选择投资期限 (如 Medium - 1-3月)
       │
       ▼
[5] 选择风险偏好 (如 Moderate - 稳健型)
       │
       ▼
[6] [可选] 输入个人洞察
       │
       ▼
[7] 点击「生成策略」按钮
       │
       ▼
[8] 等待生成完成 (观察进度)
       │
       ▼
[9] 自动跳转到「我的策略」Tab 查看结果
```

### 旅程 2: 查看策略并生成执行计划

```
[1] 进入我的策略Tab
       │
       ▼
[2] 在策略列表中找到目标策略
       │
       ▼
[3] 点击策略行查看详情
       │
       ▼
[4] 阅读投资论点、技术分析、风险因素
       │
       ▼
[5] 点击「生成计划」按钮
       │
       ▼
[6] 配置持仓状态 (无持仓/有持仓)
       │
       ▼
[7] 配置投资期限和风险偏好
       │
       ▼
[8] 点击「Generate」确认
       │
       ▼
[9] 等待计划生成完成
       │
       ▼
[10] 查看生成的执行计划 (入场价、目标价、止损价等)
```

### 旅程 3: 执行交易

```
[1] 找到已生成的执行计划
       │
       ▼
[2] 点击「执行」按钮 (模拟盘/券商)
       │
       ▼
[3] 选择目标账户
       │
       ▼
[4] 确认/调整订单参数
       │
       ├──▶ 交易方向: 买入/卖出
       ├──▶ 数量: 股数
       ├──▶ 订单类型: 市价/限价
       └──▶ 止盈止损: 可选
       │
       ▼
[5] 点击「确认」提交订单
       │
       ▼
[6] 订单执行成功
```

### 旅程 4: 与 AI 讨论策略

```
[1] 打开策略详情模态框
       │
       ▼
[2] 在左侧 AI 对话区
       │
       ▼
[3] 选择快捷问题 或 输入自定义问题
       │
       ▼
[4] 发送问题
       │
       ▼
[5] 等待 AI 回复
       │
       ▼
[6] 阅读回复，继续追问或结束
```

---

## 六、状态转换图

### 策略状态

```
                    ┌─────────────┐
                    │   生成中    │
                    │ (pending/   │
                    │ processing) │
                    └──────┬──────┘
                           │
              ┌────────────┼────────────┐
              │            │            │
              ▼            ▼            ▼
       ┌───────────┐ ┌───────────┐ ┌───────────┐
       │  成功     │ │  N/A      │ │  ERROR    │
       │ (A/B/C)   │ │ (无机会)  │ │ (失败)    │
       └─────┬─────┘ └───────────┘ └─────┬─────┘
             │                           │
             │                           │ 点击重试
             │                           ▼
             │                    ┌───────────┐
             │                    │  重新生成 │ ────▶ 回到生成中
             │                    └───────────┘
             │
             ├──────────────────────────────┐
             │                              │
             ▼                              ▼
      ┌───────────┐                  ┌───────────┐
      │  建议更新 │                  │  已失效   │
      │(needsUpdate)│                 │(isExpired)│
      └─────┬─────┘                  └───────────┘
            │
            │ 点击更新
            ▼
     ┌───────────┐
     │ 更新中... │ ────▶ 回到成功/失败
     └───────────┘
```

### 执行计划状态

```
       ┌───────────┐
       │  生成中   │
       │(isGenerating)│
       └─────┬─────┘
             │
             ▼
       ┌───────────┐
       │  已生成   │
       └─────┬─────┘
             │
      ┌──────┴──────┐
      │             │
      ▼             ▼
┌───────────┐ ┌───────────┐
│  未读     │ │  已读     │
│(isNew)    │ │           │
└─────┬─────┘ └───────────┘
      │
      │ 查看详情
      ▼
┌───────────┐
│  已读     │
└───────────┘
```

---

## 七、功能节点清单

| 模块 | 节点ID | 节点名称 | 功能类型 | 优先级 |
|------|--------|----------|----------|--------|
| A | A1.1 | 搜索股票 | 查询 | P0 |
| A | A1.2 | 关注列表 | 查询 | P1 |
| A | A2.1 | 勾选股票 | 操作 | P0 |
| A | A2.2 | 取消勾选 | 操作 | P0 |
| B | B1 | 分析框架选择 | 配置 | P0 |
| B | B2 | 投资期限选择 | 配置 | P0 |
| B | B3 | 风险偏好选择 | 配置 | P0 |
| B | B4 | 个人洞察输入 | 配置 | P2 |
| C | C1 | 生成前检查 | 校验 | P0 |
| C | C2 | 触发生成 | 操作 | P0 |
| C | C3 | 创建任务 | 系统 | P0 |
| C | C4 | 任务处理 | 系统 | P0 |
| D | D1.1 | 分组筛选 | 筛选 | P0 |
| D | D1.2 | 智能筛选 | 筛选 | P1 |
| D | D1.3 | 方向筛选 | 筛选 | P1 |
| D | D1.4 | 关键词搜索 | 查询 | P0 |
| D | D2 | 策略排序 | 操作 | P1 |
| D | D3 | 策略选择 | 操作 | P0 |
| D | D4.1 | 查看详情 | 查看 | P0 |
| D | D4.2 | 生成计划 | 操作 | P0 |
| D | D4.3 | 更新策略 | 操作 | P1 |
| D | D4.5 | 删除策略 | 操作 | P1 |
| D | D5 | 分组管理 | 操作 | P2 |
| E | E3 | 配置持仓 | 配置 | P0 |
| E | E4 | 配置偏好 | 配置 | P0 |
| E | E6 | 确认生成 | 操作 | P0 |
| F | F2 | 选择账户 | 选择 | P0 |
| F | F3 | 配置订单 | 配置 | P0 |
| F | F4 | 确认执行 | 操作 | P0 |
| G | G3 | 发送消息 | 操作 | P1 |
| G | G4 | 接收回复 | 系统 | P1 |

---

*文档版本: 1.0*  
*编写日期: 2026-01-20*
